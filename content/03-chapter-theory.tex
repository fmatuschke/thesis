\cleardoublepage
\setcounter{chapter}{2}
\chapter{Modeling of Light}
\label{sec:theory}
%
\section{Introduction}
The following chapter lists the physical theory needed to describe the mathematics behind \ac{3D-PLI}.
These include the basic properties of light, such as its polarization state, the optical properties of nerve fibers tissue, the mathematical description of the \ac{3D-PLI} experimental setup and its signal analysis.
The chapter drew inspiration from the work presented in \cite{demtroeder2, Fliebach2012}.
%
%
%
\section{Electromagnetic Waves}
%
Light is an electromagnetic wave.
The theory of electromagnetism was first fully described by James Clerk Maxwell, who formulated Maxwell's equations (see \cref{eq::maxwell_general}), generalized from the previous work of Johann Carl Friedrich Gau{\ss}, Michael Faraday and Andr\'{e}-Marie Amp\`{e}re and others:
%
\begin{align}
\begin{split} \label[pluralequation]{eq::maxwell_general}
    \nabla \cdot \vec{E} &= \frac {\rho} {\varepsilon_0}\\
    \nabla \cdot \vec{B} &= 0\\
    \nabla \times \vec{E} &= -\frac{\partial \vec{B}} {\partial t}\\
    \nabla \times \vec{B} &= \mu_0 \left( \vec{j} + \varepsilon_0 \frac{\partial \vec{E}} {\partial t} \right)
\end{split}
\end{align}
%
with the nabla operator $\nabla \coloneqq \left({\frac{\partial}{\partial x}}, {\frac{\partial}{\partial y}}, {\frac{\partial}{\partial z}} \right)$ denotes the three-dimensional gradient operator, $\vec{E}$ as electric field, $\rho$ as electric charge density, $\varepsilon_0$ as permittivity of free space, $\vec{B}$ as magnetic field, $\mu_0$ as permeability of free space and $\vec{j}$ as electric current density.
The first equation states that no electric field can be generated without an electric charge (conservation of charge).
The second equation states that there are no magnetic monopoles and the basic unit of a magnetic field is a dipole.
The third and fourth equations show the relationship between the electric and magnetic fields in space and time.
A change in the electric field results in a magnetic field and vice versa.
Equation four also shows a magnetic field's generation from an electric current $\vec{j}$.
Maxwell's equation satisfies the continuity equation $\divergence j + \frac{\partial \rho}{\partial t} = 0$, which means that neither an electric field nor a magnetic field can be generated without an electric current or a change in electric potential occurring.
%
% \par
%
\subsection{Light in vacuum}
%
In a vacuum, \cref{eq::maxwell_general} simplifies with $\rho = 0$ and $\vec{j} = \vec{0}$ to:
%
\begin{align}
\begin{split} \label[pluralequation]{eq::maxwell_vacuum}
  \nabla \cdot \vec{E} &= 0 \quad\\
  \nabla \cdot \vec{B} &= 0 \quad\\
  \nabla \times \vec{E} &= -\frac{\partial\vec B}{\partial t}\\
  \nabla \times \vec{B} &= \mu_0\varepsilon_0 \frac{\partial\vec E}{\partial t}
  \end{split}
\end{align}
%
with
\begin{align}
\begin{split}
    \nabla \times \nabla \times \vec{E} = -\nabla \times \frac{\partial \vec{B}} {\partial t} &= -\frac{\partial} {\partial t} \left( \nabla \times  \vec{B} \right)\\
    &= -\varepsilon_0 \cdot \mu_0 \frac{\partial^2 \vec{E}}{\partial t^2} \, ,
\end{split}
\end{align}
%
the identity $\nabla \times \left( \nabla \times \vec{A} \right) = \nabla(\nabla \cdot \vec{A}) - \nabla^{2}\vec{A}$, $\mu_0\varepsilon_0 = \frac{1}{c^2}$ and $c$ as the speed of light\footnote{can be derived from Maxwell's equation and Lorentz force in a vacuum}, further simplifies to:
%
\begin{align}
\begin{split} \label[pluralequation]{eq::maxwell_wave_equations}
  \frac{1}{c^2} \frac{\partial^2 \vec{E}}{\partial t^2} - \nabla^2 \vec{E} &= \vec{0} \\
  \frac{1}{c^2} \frac{\partial^2 \vec{B}}{\partial t^2} - \nabla^2 \vec{B} &= \vec{0}
\end{split}
\end{align}
%
which shows that $c^2 \frac{\partial B} {\partial z} = \frac{\partial E}{\partial t} \Rightarrow \vec{E} \cdot \vec{B} = 0$ and thus the electric and magnetic field components are perpendicular to each other.
Furthermore, this implies that space and time are linked, and that light propagates in vacuum with the speed of light $c$.
% 
% 
%
\subsection{Solving Maxwell's equations in vacuum}\label{sec::SolvMaxEqVac}
%
\Cref{eq::maxwell_wave_equations} have the form of a wave equation and therefore, it can be solved by
%
\begin{align}
\begin{split} \label[pluralequation]{eq::dgl_solution}
  \vec{E}( \vec{r}, t ) &= g(\phi( \vec{r}, t )) = g( \omega t - \vec{k} \cdot \vec{r} + \varphi)\\
  \vec{B}( \vec{r}, t ) &= g(\phi( \vec{r}, t )) = g( \omega t - \vec{k} \cdot \vec{r} + \varphi )
\end{split}
\end{align}
%
where $g$ is any well-behaved function (continuous and differentiable) and therefore also its superposition, $\omega$ the circular frequency, $t$ the time, $\vec{k}$ the wave vector, $\vec{r}$ the spacial position and $\varphi$ the phase.
%
With the help of
%
\begin{align}
k = \mathopen| \vec{k} \mathclose| = \frac{\omega}{c} =  \frac{2 \pi}{\lambda}
\end{align}
%
a planar wave can be described by
%
\begin{align}
\begin{split} \label[pluralequation]{eq::plane_wave}
\vec{E}(\vec{r}) &= \vec{E}_0 \cdot e^{ -i \, \vec{k} \cdot \vec{r} }\\
 \vec{B}(\vec{r}) &= \vec{B}_0 \cdot e^{ -i \, \vec{k} \cdot \vec{r} }
\end{split}
\end{align}
%
with $\vec{k}$ as wave vector pointing in the direction of the propagation of the light wave (see \cref{fig:polarization_state}).
%
%
\subsection{Polarization}\label{sec:polarization}
%
Since the light wave propagates in one direction and the electric field and magnetic field are perpendicular to $\vec{k}$ and to each other, the orientation of the plane of oscillation is a fundamental property of light called polarization (see \cref{fig:polarization_state}).
%
\begin{figure}[!t]
\centering
\setlength{\tikzwidth}{\textwidth}
\inputtikz{gfx/pli/polarization_state}
\caption{Illustration of the polarization state of light. Unpolarized light passes through a linear polarizer, polarizing the light in one direction. It then passes through a quarter-wave retarder that converts linearly polarized light (of a specific wavelength) into circularly polarized light, where $E_x$ and $E_y$ are $\pi/2$ in phase.}
\label{fig:polarization_state}
\end{figure}
% 
Without additional information, the polarization orientation is conventionally in the direction of the electric field component.
A superposition of x- and y-wave with z-axis equal to the propagation direction gives the general form:
% 
\begin{align}
    \vec{E}(z,t) &= \begin{pmatrix} E_{0x} \cdot e^{ -i \phi_x } \\ E_{0y} \cdot e^{ -i \phi_y } \\ 0 \end{pmatrix}
e^{ -i (kz - \omega t)}
\end{align}
%
\Cref{fig:polarization_state_vectors} shows an additional representation of the polarization state of a light wave.
It shows the component perpendicular to the propagation direction.
Thus, the time evolution of the electric field can be represented in the $xy$-plane.
In addition, the states can be described by the Jones or Stokes calculation, which is described in \cref{sec:jones,sec:MuellerStokes}.
%
\begin{figure}[!t]
\centering
% \tikzset{external/export=false}
\input{gfx/pli/pol_states}
\caption{Polarization states in Jones and Stokes convention.}
\label{fig:polarization_state_vectors}
\end{figure}
%
%
%
\subsection{Light in a medium}
%
The general Maxwell's equations \cref{eq::maxwell_general} can be solved similar to \cref{sec::SolvMaxEqVac}, which yields a special behavior, \eg{} the magnetic and electric field component get out of phase.
In this work, only the two decisive properties absorption and diffraction are described.
% 
% 
%
\subsection{Absorption}\label{sec:theoAbsorption}
%
Absorption is the property of reducing the intensity or energy of an electromagnetic wave passing through a medium.
It is described by Beersche law of absorption
% 
\begin{align} 
    I = I_0 \exp(-\mu x) \label{eq:absorption}
\end{align}
%
with $\mu = \frac{4\pi \kappa}{\lambda}$ where $\lambda$ is the wavelength and $\kappa$ is the imaginary part of the complex refractive index of the medium (see \cref{sec:theoRefraction}).
If the complex number is inserted into the wave equation, the intensity is reduced exponentially along the path (see \cref{eq:absorption}).
%
% 
% 
\subsection{Refraction}\label{sec:theoRefraction}
%
Refraction is the change of direction of light as it passes from one medium to another.
Refraction can be explained by using the full Maxwell equations for non-conductive material, 
%, \ie{}, $\vec{j} = \vec{0}$ \TODO{$, \rho = 0$}, 
\ie{} the differential equation consist out of a primary wave with from atomic medium induced secondary waves, which leads to a reduction of the velocity of the resulting wave.
Mathematically, this can be described by a complex number $n = c' / c$.
Using this relationship at a boundary surface between two media, one can show that the incident light beam splits into a reflecting and transmitting light wave.
The reflecting light wave has the same angle as the incident light beam relative to the surface normal.
% 
However, the transmitting light beam, due to the reduction of the velocity, changes its direction described by the Snellius law (see \cref{fig:optic_refraction}):
%
\begin{figure}[!t]
\centering
\setlength{\tikzwidth}{\textwidth}
\inputtikz{gfx/pli/refraction}
\caption{Illustration of refraction by Snellius law.}
\label{fig:optic_refraction}
\end{figure}
% 
\begin{align}
    n_\alpha \sin \alpha = n_\beta \sin \beta \label{eq:Snellius}
\end{align}
% 
The refractive index $n$ can also be described inside a complex refraction index, where the imaginary part describes the absorption of the light along the material (see \cref{sec:theoAbsorption}):
% 
\begin{align}
\underline{n} = n + i\kappa
\end{align}
% 
%
%
\subsection{Birefingence}
%
A translucent material can have a different refractive index depending on the relative orientation and polarization of the light beam.
This property is called birefringence.
The refractive index can be described by the ordinary refractive index $n_o$ and the extraordinary $n_e$, which are perpendicular to each other (see \cref{fig:optic_retardation}).
%
\begin{figure}[!t]
\centering
\setlength{\tikzwidth}{\textwidth}
\inputtikz{gfx/pli/retardation}
\caption{Illustration of retardation. The linear $\SI{45}{\degree}$ polarized light wave is decomposed into the $x$ and $y$ components in the birefringence medium. The $y$ component travels faster than the $x$ component. Therefore, a phase shift $\phi$ between both components occur. This leads in the case of a $\lambda/4$ retarder to a circular polarized light wave.}
\label{fig:optic_retardation}
\end{figure}
% 
Therefore, the light ray can be split into the same perpendicular parts and each can be described by itself.
These two light rays can have a different direction due to refraction.
If the separation is relatively small, the two light beams (or multiple light beams) can be modeled as they would recombine when leaving the material.
The phase change is called birefringence and the physical property is described by:
%
\begin{align}
    \Delta n = n_e - n_o \> .
\end{align}
%
%
%
\subsection{Jones calculus}
\label{sec:jones}
% 
The Jones calculus, introduced by Robert Clark Jones in 1941, describes the polarization state of a light beam by a complex vector $J$ (see \cref{fig:polarization_state_vectors}):
%
\begin{align}
    \vec{J} = \begin{pmatrix} E_x \exp(i \varphi_x) \\ E_y \exp(i \varphi_y) \end{pmatrix}
\end{align}
%
The amplitude of the perpendicular components are $E_x$ and $E_y$ with their phase $\varphi_x$ and $\varphi_y$.
Optical elements that change the polarization state, such as polarization filters and retarders, can be described by a matrix:
%
\paragraph{Linear polarizer}
\begin{align}
\mat{P}_x =
\begin{pmatrix}
1 & 0 \\ 0 & 0
\end{pmatrix}
, \enspace
\mat{P}_y =
\begin{pmatrix}
0 & 0 \\ 0 & 1
\end{pmatrix}
\end{align}
% 
\paragraph{Retarder (fast axis x-axis)}
\begin{align}
\mat{M} =
\begin{pmatrix}
e^{i \delta_x} & 0 \\ 0 & e^{i \delta_y}
\end{pmatrix}
, \enspace
% 
\Lambda_{1/4}=
e^{\frac{i \pi}{4}}
\begin{pmatrix}
1 & 0 \\ 0 & -i
\end{pmatrix}
\end{align}
% 
with $\delta$ as retardation and $\Lambda_{1/4}$ as quarter-wave retarder.
%
\paragraph{Rotation matrix}
A rotation of an optical element $\mat{E}$ can be achieved by a 2D rotation matrix $\mat{R}$:
\begin{align}
\begin{split}\label{eq::JonesRotation}
\mat{A}(\theta )=\mat{R}(\theta )\cdot\mat{A}\cdot\mat{R}(-\theta )
, \enspace
\mat{R}(\theta ) =
\begin{pmatrix}
\cos \theta & -\sin \theta \\
\sin \theta & \cos \theta
\end{pmatrix}
\end{split}
\end{align}
% 
%
%
\subsection{M{\"u}ller-Stokes calculus}\label{sec:MuellerStokes}
%
In analogy to \cref{sec:jones}, the M{\"u}ller-Stokes formalism, described by George Gabriel Stokes in 1852, also describes the polarization state of a light beam.
However, it does not use the absolute electric components, but the relative polarization between both components (see \cref{fig:polarization_state_vectors}):
%
\paragraph{Stokes vector}
\begin{align}
% 
\vec{S} =
\begin{pmatrix} S_0 \\ S_1 \\ S_2 \\ S_3\end{pmatrix} , \quad
% 
\begin{split}
S_0 &= I \\
S_1 &= I p \cos 2\psi \cos 2\chi \\
S_2 &= I p \sin 2\psi \cos 2\chi \\
S_3 &= I p \sin 2\chi
\end{split}
% 
\hspace{-7em}
% 
\begin{split}
& \\
& \\
&= 2 E_x E_y \cos \delta \\
&= 2 E_x E_y \sin \delta
\end{split}
\end{align}
%
where $I$ is the intensity, $p$ the polarization state, $\Psi$ and $\delta$ the relative phases between the $E_x$ and $E_y$ components, which can also be described by the two angles $\Psi$ and $\chi$ and visualized on the Poincar\'{e} sphere (see \cref{fig:stokesPoincare}).
%
\begin{figure}[!t]
% \setlength{\tikzwidth}{\textwidth}
\centering
\inputtikz{gfx/pli/poincare}
\caption{Poincar\'{e} sphere illustrating Stokes component.}
\label{fig:stokesPoincare}
\end{figure}
% 
With this description, the phase can no longer be described as in the Jones calculus.
However, the relative phase information is stored and can be used to describe also polarization states of polarization filters, which the Jones calculus cannot describe.
Analogous to the Jones calculus, one can formulate the matrices for the optical components:
%
\paragraph{Linear polarizer}
\begin{align}
\mat{P}_x=\frac{1}{2}
\begin{pmatrix}
    1 & 1 & 0 & 0 \\
    1 & 1 & 0 & 0 \\
    0 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0
  \end{pmatrix}
, \;
\mat{P}_y=\frac{1}{2}
\begin{pmatrix}
     1 & -1 & 0 & 0 \\
    -1 &  1 & 0 & 0 \\
     0 &  0 & 0 & 0 \\
     0 &  0 & 0 & 0
\end{pmatrix}
\end{align}
%
\paragraph{Retarder (fast axis x-axis)}
\begin{align}
\mat{M}=\
\begin{pmatrix}
    1 & 0 & 0 &  0 \\
    0 & 1 & 0 &  0 \\
    0 & 0 & \cos \delta & \sin \delta \\
    0 & 0 & -\sin \delta &  \cos \delta
\end{pmatrix}
, \enspace
% 
\Lambda_{1/4}=\
\begin{pmatrix}
    1 & 0 & 0 &  0 \\
    0 & 1 & 0 &  0 \\
    0 & 0 & 0 & -1 \\
    0 & 0 & 1 &  0
\end{pmatrix}
\end{align}
with $\delta$ as retardation and $\Lambda_{1/4}$ as quarter-wave retarder.
%
\paragraph{Rotation matrix}
Analog to \cref{eq::JonesRotation} rotations of an optical element $\mat{E}$ are applied by
\begin{align}
\centering
\begin{gathered}
\mat{R}(\theta)=
\begin{pmatrix}
    1 &                0 &               0 & 0 \\
    0 & \cos{(2\theta)} & -\sin{(2\theta)} & 0 \\
    0 & \sin{(2\theta)} & \cos{(2\theta)} & 0 \\
    0 &                0 &               0 & 1
\end{pmatrix} \\[0.5em]
\mat{A}(\theta)
=\mat{R}(\theta )\cdot\mat{A}\cdot\mat{R}(-\theta )
\end{gathered}
\end{align}